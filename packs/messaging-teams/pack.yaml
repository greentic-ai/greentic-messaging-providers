pack_id: messaging-teams
version: 0.0.0
kind: application
publisher: Greentic

components:
  - id: "messaging-provider-teams"
    kind: messaging
    version: 0.0.0
    world: "greentic:provider/schema-core@1.0.0"
    supports: ["messaging"]
    profiles:
      default: "default"
      supported: ["default"]
    capabilities:
      wasi: {}
      host: {}
    wasm: "components/messaging-provider-teams.wasm"

extensions:
  greentic.ext.provider:
    kind: greentic.ext.provider
    version: 0.0.0
    inline:
      providers:
        - provider_type: "messaging.teams.graph"
          capabilities: ["messaging"]
          ops: ["send", "reply"]
          config_schema_ref: "schemas/messaging/teams/config.schema.json"
          state_schema_ref: ""
          runtime:
            component_ref: "messaging-provider-teams"
            export: "schema-core-api"
            world: "greentic:provider/schema-core@1.0.0"
          docs_ref: ""

schemas:
  - kind: config
    version: 0.0.0
    path: "schemas/messaging/teams/config.schema.json"

secret_requirements:
  - name: "MS_GRAPH_CLIENT_SECRET"
    scope: "tenant"
    description: "Client secret used for Graph access tokens."
  - name: "MS_GRAPH_REFRESH_TOKEN"
    scope: "tenant"
    description: "Refresh token used when invoking refresh_token grant."

dependencies: []

assets: []
